<div id="modalWrap"> <!-- 모달 창을 감싸는 div -->
    <div id="modalBody">
        <span id="closeBtn">&times;</span> <!-- 모달을 닫는 X 버튼 -->
        <div id="modalData">

        </div>
    </div>
</div>
<style>


</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const images = document.querySelectorAll('.top10-movie-img');
        const modal = document.getElementById('modalWrap'); // 모달 창 요소 가져오기
        const closeBtn = document.getElementById('closeBtn'); // 모달을 닫는 버튼(X) 요소 가져오기
        const modalData = document.getElementById('modalData'); // 모달 내용 요소 가져오기

        images.forEach(img => {
            img.addEventListener('click', function () {
                const contentId = this.dataset.contentId;
                showModal(contentId);
            });
        });

        closeBtn.onclick = function () {
            modal.style.display = "none"; // 모달을 닫는 버튼(X)을 클릭하면 모달을 숨김
            document.body.style.overflow = "auto";
        };

        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none"; // 모달 외부를 클릭하면 모달을 숨김
                document.body.style.overflow = "auto";
            }
        };

        function showModal(contentId) {
            modal.style.display = "block"; // 모달을 보이게 함
            document.body.style.overflow = "hidden";

            // AJAX 통신으로 데이터 가져오기
            fetch(`/api/content-info/${contentId}`)
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
                        modalData.innerHTML = `
                    <div class="body-container">
                        <!-- 헤더 start -->
                        <div class="header-container">
                          <img src="${data.response.mainPhoto}" class="background-image"/>
                            <div class="play">
                                <div class="title">
                                    <img src="${data.response.textPhoto}" />
                                </div>
                                <div class="buttons">
                                    <a href="#" class="play-button">▶ 재생</a>
                                    ${data.response.isFavorite ?
                                `<form action="/api/users/${contentId}/unfavorite" method="post">
                            <button type="submit" class="icon"><i class="fa-regular fa-circle-check"></i></button>
                         </form>` :
                                `<form action="/api/users/${contentId}/favorite" method="post">
                            <button type="submit" class="icon"><i class="fa-solid fa-plus"></i></button>
                         </form>`
                        }
                                    <a href="#" class="icon"><i class="fa-regular fa-thumbs-up"></i></a>
                                </div>
                            </div>
                        </div>
                        <!-- 헤더 end -->

                        <div class="containermargin">
                            <div class="container">
                                <div class="introduce">
                                    <div class="info">
                                        <span class="match">98% 일치</span>
                                        <span>${data.response.productYear}</span>
                                        <span>${data.response.playTime}</span>
                                        <span>HD</span>
                                    </div>
                                    <div class="metadata">
                                        <div><img src="${data.response.rateImg}" alt="" /></div>
                                    </div>
                                    <div class="description">
                                        ${data.response.introduction}
                                    </div>
                                </div>
                                <div class="details">
                                    <div class="cast">출연: ${data.response.actors}</div>
                                    <div class="genre">장르: ${data.response.genre} 영화</div>
                                    <div class="features">영화 특징: ${data.response.characteristics}</div>
                                </div>
                            </div>
                            <div class="container2">
                                <div class="title2">${data.response.title}상세 정보</div>
                                <div class="details2">
                                    <div>감독: ${data.response.director}</div>
                                    <div>출연: ${data.response.actors}</div>
                                    <div>각본: ${data.response.writers}</div>
                                    <div>장르: ${data.response.genre} 영화</div>
                                    <div>영화 특징: ${data.response.characteristics}</div>
                                    <div class="rating">
                                        <span>관람등급: <img src="${data.response.rateImg}" alt="" />${data.response.rate}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                    })
                    .catch(error => {
                        modalData.innerText = 'Error loading data';
                        console.error('Error:', error);
                    });
        }
    });
</script>